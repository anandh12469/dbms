Excercise -40

select sid,sname,location from Salesman where sname like '%e%' and location like '%o%'
union all
select sid,sname,location from Salesman where sname like '%a%' and location like '%a%'

eXCERCISE -41

select prodid,pdesc,category,discount from Product where discount < 10 UNION ALL select prodid,pdesc,category,discount from Product where CATEGORY IN 'Sports' 

Excercise -42

select prodid,pdesc,category,discount from Product where discount < 10 UNION  select prodid,pdesc,category,discount from Product where CATEGORY IN 'Sports' 

Excercise -43

select 'S' as Type,sid as id,sname as details  from salesman 
union
select 'P' as Type,prodid as id,category as details  from product 

Excercise -44

select id,ename,dept,e.compid,c.make 
from employee e inner join computer c 
on e.compid=c.compid

Excercise -45

select id,ename,e.compid,c.make 
from employee e inner join computer c on e.compid=c.compid
where c.model='Precision' or  c.model='Edge'

Excercise -46

select e.dept,count(c.make) "NUMBER OF COMPUTERS" from employee e 
inner join computer c 
on make='Dell' and e.compid=c.compid
group by e.dept,c.make

Excercise -47

select Salesman.sid,Sale.sldate from Salesman  join Sale on Salesman.sid=Sale.sid where Salesman.location in 'London'

Excercise-48

select s.sid,s.sname,s.location 
from salesman s 
inner join salesman m on 
s.sid!=m.sid and s.location=m.location

Excercise -49

select m.sname,s.saleid
from salesman m left outer join sale s on s.sid=m.sid

Excercise-50

select s.sid,s.sname,sum(p.price*sd.quantity) as TAMOUNT,sum(((p.discount*p.price)/100)*sd.quantity) as Tdiscount from salesman s
join sale sa on sa.sid = s.sid
join saledetail sd on sd.saleid=sa.saleid
join product p on p.prodid=sd.prodid
group by s.sid,s.sname
order by TAMOUNT desc

Excercise -51

select s.saleid,sd.prodid,s.sid,sm.sname from sale s 
join Saledetail sd on sd.saleid=s.saleid
join salesman sm on sm.sid=s.sid

Excercise -52 (logical error)

select s.sid,s.sname,nvl(sum(p.price*sd.quantity),0) as TAMOUNT,nvl(sum(((p.discount*p.price)/100)*sd.quantity),0) as Tdiscount from salesman s
left join sale sa on sa.sid = s.sid
left join saledetail sd on sd.saleid=sa.saleid
left join product p on p.prodid=sd.prodid
group by s.sid,s.sname
ORDER BY TAMOUNT NULLS FIRST

Excercide -53

select sm.location,p.category,sum(sd.quantity) as "Total Quantity" from salesman sm
join sale s on s.sid=sm.sid
join saledetail sd  on sd.saleid=s.saleid
join product p on p.prodid=sd.prodid
group by sm.location,p.category

Excercise -54

select e.ename,e.dept,nvl(c.model,'Not allocated') model from employee e 
left join computer c on c.compid = e.compid 

Excercise - 55

select e.id,e.ename,e.dept,c.model from employee e
full join computer c on c.compid = e.compid

Excercise - 56

select m.id,m.ename,m.manager mgrid,e.ename mgrname,c.model e_model,t.model m_model from employee m 
join employee e on e.id=m.manager 
join computer c on c.compid=m.compid 
join computer t on t.compid=e.compid

Excercise -57

select s.sid,s.sname 
from salesman s 
left join sale m on s.sid=m.sid
where m.sid is null

Excercise -58

select  n.prodid,n.category,n.price from product n
join product p on p.price = n.price and p.prodid != n.prodid

Assignment -67

select e.ename,e.sal,d.dname from emp e 
join dept d on d.deptno=e.deptno where e.sal >2000

Assignment -68

select e.ename,d.dname from emp e 
join dept d on d.deptno=e.deptno where job in 'MANAGER'

Assignment -69 

select d.dname from dept d 
join emp e on e.deptno=d.deptno  where e.sal >1500   group by d.dname having count(d.dname) > 1

Assignment -70

select e.ename,v.vehiclename from emp e
left join empvehicle ev on ev.EmpNo = e.EmpNo
left join vehicle v on v.vehicleid = ev.vehicleid

Assignment -71

select i.itemcode,i.descr,q.sname 
from item i 
inner join quotation q 
on i.itemcode=q.itemcode 

Assignment -72

select c.custid "Customer Id",c.custname "Customer Name"
from customer c join 
empdetails e on e.emailid=c.emailid

Assignment -73

select i.itemcode,i.descr,i.category,q.quotedprice from item i
join quotation q on q.itemcode=i.itemcode where q.qstatus='Accepted' 

Assignment -74

select r.roid,i.descr,i.itemtype,r.unitprice from retailstock r
join item i on i.itemcode=r.itemcode where r.unitprice >1500

Assignment -75

select q.itemcode,q.sname,sum(o.qtyordered) as totalquantity from orders o 
join quotation q on q.quotationid=o.quotationid 
group by o.quotationid,q.sname,q.itemcode 
having sum(o.qtyordered) >=100 

Assignment -76

select i.itemcode,i.descr from item i
join quotation q on q.itemcode=i.itemcode
where q.quotedprice in '120' group by i.itemcode,i.descr

